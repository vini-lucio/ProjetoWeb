{% extends "estoque/base.html" %}

{% block conteudo %}

    <section class="principal">

        <div class="link-conteudo link-conteudo-grande">
            <div class="titulo">
                <h1>{{  titulo_pagina  }} <a target="_blank" href="{% url "dashboards:estoque" %}">⊕</a></h1>
            </div>

            <form id="form" method="get" class="fonte-maior">
                <div class="grid-simples link-conteudo link-conteudo-grande">
                    {{ formulario.as_p }}
                </div>
                <div class="grid link-conteudo fonte-maior">
                    <button class="botao botao-escuro" form="form" name="pesquisar-submit" type="submit">Pesquisar</button>
                    <a href="{% url "estoque:estoque" %}?pesquisar=Embalagem&pesquisar-submit=">
                        <div class="botao-div">Embalagem{% if embalagem.quantidade_pallets %}<span class="fonte-vermelho"> ({{ embalagem.quantidade_pallets }})</span>{% endif %}</div>
                    </a>
                    <a href="{% url "estoque:estoque" %}?pesquisar=Expedição&pesquisar-submit=">
                        <div class="botao-div">Expedição{% if expedicao.quantidade_pallets %}<span class="fonte-vermelho"> ({{ expedicao.quantidade_pallets }})</span>{% endif %}</div>
                    </a>
                    <a href="{% url "estoque:estoque" %}?pesquisar=Recebimento&pesquisar-submit=">
                        <div class="botao-div">Recebimento{% if recebimento.quantidade_pallets %}<span class="fonte-vermelho"> ({{ recebimento.quantidade_pallets }})</span>{% endif %}</div>
                    </a>
                    <a href="{% url "estoque:estoque" %}?pesquisar=Picking+Produção&pesquisar-submit=">
                        <div class="botao-div">Picking Produção{% if picking_producao.quantidade_pallets %}<span class="fonte-vermelho"> ({{ picking_producao.quantidade_pallets }})</span>{% endif %}</div>
                    </a>
                    <a href="/admin/estoque/produtospallets/add/">
                        <div class="botao-div botao-escuro">Incluir</div>
                    </a>
                    <a href="/admin/analysis/oc_mp_itens/">
                        <div class="botao-div botao-escuro">Incluir OC MP</div>
                    </a>
                </div>
            </form>
            {% if quantidade_reprovados %}
                <form id="form-reprovado" method="get" class="fonte-maior">
                    <div class="grid link-conteudo fonte-maior">
                        <button class="botao botao-vermelho" form="form-reprovado" name="reprovado-submit" type="submit">Reprovados<span class="fonte-verde"> ({{ quantidade_reprovados }})</span></button>
                    </div>
                </form>
            {% endif %}
        </div>

        

        <div class="link-conteudo link-conteudo-grande fonte-maior">

            {% if erros %}
                <p>{{ erros }}</p>
            {% endif %}

            {% if dados %}
                <div class="tabela-simples">
                    <table>
                        <tr>
                            <th>Endereço</th>
                            <th>Col.</th>
                            <th>Alt.</th>
                            <th>ID Emb.</th>
                            <th>Itens</th>
                            <th>Produto</th>
                            <th>Un.</th>
                            <th>Quantidade</th>
                            <th>Fornecedor</th>
                            <th>Lote</th>
                        </tr>
                        {% for produto_pallet in dados %}
                            <tr class="{% if produto_pallet.aprovado %}{% cycle 'principal-azul-claro' '' %}{% else %}principal-vermelho{% endif %}">
                                <td class="fonte-roxo"><a href="{% url "estoque:mover" produto_pallet.pk %}?destino={{ request.get_full_path | urlencode}}">{{ produto_pallet.endereco }}</a></td>
                                <td class="fonte-roxo"><a href="{% url "estoque:mover" produto_pallet.pk %}?destino={{ request.get_full_path | urlencode}}">{{ produto_pallet.endereco_coluna }}</a></td>
                                <td class="fonte-roxo"><a href="{% url "estoque:mover" produto_pallet.pk %}?destino={{ request.get_full_path | urlencode}}">{{ produto_pallet.endereco_altura }}</a></td>
                                <td></td>
                                <td>{{ produto_pallet.pallet.quantidade_produtos }}</td>
                                <td>{{ produto_pallet.produto.nome }}</td>
                                <td>{{ produto_pallet.unidade }}</td>
                                <td class="fonte-roxo"><a href="{% url "estoque:alterar" produto_pallet.pk %}?destino={{ request.get_full_path | urlencode}}">{{ produto_pallet.quantidade | floatformat:3 }}</a></td>
                                <td class="fonte-roxo">{% if produto_pallet.fornecedor %}<a href="{% url "estoque:alterar" produto_pallet.pk %}?destino={{ request.get_full_path | urlencode}}">{{ produto_pallet.fornecedor }}</a>{% endif %}</td>
                                <td class="fonte-roxo">{% if produto_pallet.lote_fornecedor %}<a href="{% url "estoque:alterar" produto_pallet.pk %}?destino={{ request.get_full_path | urlencode}}">{{ produto_pallet.lote_fornecedor }}</a>{% endif %}</td>
                            </tr>
                        {% endfor %}
                        {% if total_kg %}
                            <tr class="principal-claro">
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="azul-negrito">Total</td>
                                <td class="azul-negrito">KG</td>
                                <td class="azul-negrito">{{ total_kg | floatformat:3 }}</td>
                                <td></td>
                                <td></td>
                            </tr>
                        {% endif %}
                    </table>
                </div>
            {% endif %}

        </div>

    </section>

{% endblock conteudo %}